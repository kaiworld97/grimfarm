{% extends 'base.html' %}

{% load static %}

{#타이틀 넣는 곳#}
{% block title %}
    upload
{% endblock %}

{# css 파일 넣는 곳#}
{% block css %}
    <link rel="stylesheet" href="{% static '/css/upload.css' %}">
{% endblock %}

{#자바스크립트 파일 넣는 곳#}
{% block js %}
    <script>
        function posting() {
            let file = $('#select_file')[0].files[0]
            var num = $('input[name=style]:checked').val();
            let file_id = document.getElementById('select_file').value.split('\\')[2].split('.')[0]
            let key = String(new Date().getTime()) + file_id
            let form_data = new FormData()


            form_data.append("img", file)
            form_data.append("num", num)
            form_data.append("key", key)

            $.ajax({
                type: "POST",
                url: 'http://127.0.0.1:5000/api/v1/nsts/',
                data: form_data,
                cache: false,
                contentType: false,
                processData: false,
                enctype: 'multipart/form-data',
                success: function (response) {
                    console.log(response['file_url'])
                    let output = document.getElementById('output')
                    let out_img = document.createElement("img");
                    out_img.src = response['file_url']
                    out_img.style.width = "100%";
                    out_img.style.height = "100%";
                    out_img.style.visibility = "visible";
                    out_img.style.objectFit = "cover"
                    output.appendChild(out_img);
                }
            });
        }
    </script>
{% endblock %}

{#메인 컨텐츠 들어가는 곳#}
{% block content %}
    <div class="upload_container">
        <div class="input_container">
            <img src={% static '/img/디폴트.jpeg' %}>
            <input type="file" id="select_file">
        </div>
        <div class="style_box">
            <div id="select_box">
                <img src="{% static '/img/칸딘스키.jpeg' %}">
                <input type="radio" id="select_num" name="style" value="1">
            </div>

            <div id="select_box">
                <img src={% static '/img/피카소.jpeg' %}>
                <input type="radio" id="select_num" name="style" value="2">
            </div>

            <div id="select_box">
                <img src={% static '/img/고흐.jpeg' %}>
                <input type="radio" id="select_num" name="style" value="3">
            </div>

            <div id="select_box">
                <img src={% static '/img/밥로스.jpeg' %}>
                <input type="radio" id="select_num" name="style" value="4">
            </div>

            <div id="select_box">
                <img src={% static '/img/호크니.jpeg' %}>
                <input type="radio" id="select_num" name="style" value="5">
            </div>

            <div id="select_box">
                <img src={% static '/img/뭉크.jpeg' %}>
                <input type="radio" id="select_num" value="6">
            </div>

            <div id="select_box">
                <img src={% static '/img/옛날.jpeg' %}>
                <input type="radio" id="select_num" name="style" value="7">
            </div>

            <div id="select_box">
                <img src={% static '/img/점묘.jpeg' %}>
                <input type="radio" id="select_num" name="style" value="8">
            </div>

            <div id="select_box">
                <img src={% static '/img/모네.jpeg' %}>
                <input type="radio" id="select_num" name="style" value="9">
            </div>

            <div id="select_box">
                <img src={% static '/img/고흐2.jpeg' %}>
                <input type="radio" id="select_num" name="style" value="10">
            </div>
        </div>

    </div>
    <div class="transfer">
        <button onclick="posting()">create</button>
    </div>
    <div id="output"></div>

{% endblock %}

